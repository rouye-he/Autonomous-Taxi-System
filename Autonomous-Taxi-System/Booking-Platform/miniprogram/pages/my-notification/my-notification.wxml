<navigation-bar title="æˆ‘çš„é€šçŸ¥" back="{{true}}" color="black" background="#FFF"></navigation-bar>

<view class="container">
  <!-- å†…å®¹åŒºåŸŸå®¹å™¨ -->
  <view class="content-area">
    <!-- å¯¼èˆªæ  -->
    <view class="tab-navigation">
      <view 
        class="tab-navigation-item {{activeTab === 0 ? 'active' : ''}}"
        bindtap="onTabChange"
        data-index="0"
      >
        æœªè¯»
        <text class="tab-count" wx:if="{{unreadCount > 0}}">({{unreadCount}})</text>
      </view>
      <view 
        class="tab-navigation-item {{activeTab === 1 ? 'active' : ''}}"
        bindtap="onTabChange"
        data-index="1"
      >
        å·²è¯»
        <text class="tab-count" wx:if="{{readCount > 0}}">({{readCount}})</text>
      </view>
    </view>

    <!-- å†…å®¹åˆ—è¡¨ -->
    <view class="content-list">
      <!-- åŠ è½½çŠ¶æ€ -->
      <view class="loading-state" wx:if="{{loading}}">
        <view class="loading-text">åŠ è½½ä¸­...</view>
      </view>

      <!-- æœªè¯»é€šçŸ¥å†…å®¹ -->
      <block wx:elif="{{activeTab === 0}}">
        <view class="notification-list" wx:if="{{unreadNotifications.length > 0}}">
          <view 
            class="notification-item"
            wx:for="{{unreadNotifications}}"
            wx:key="notification_id"
            bindtap="markAsRead"
            data-id="{{item.notification_id}}"
          >
            <view class="notification-header">
              <view class="notification-info">
                <text class="notification-title">{{item.title}}</text>
                <text class="notification-time">{{formatTime(item.create_time)}}</text>
              </view>
              <view class="right-info">
                <text class="notification-date">{{item.create_time}}</text>
              </view>
            </view>

            <view class="notification-content">
              <text class="notification-text">{{item.content}}</text>
            </view>

            <view class="notification-footer">
              <text class="notification-type">{{item.target_type === 0 ? 'ç³»ç»Ÿé€šçŸ¥' : 'ä¸ªäººé€šçŸ¥'}}</text>
            </view>
          </view>
        </view>

        <!-- ç©ºçŠ¶æ€å¡ç‰‡ -->
        <view class="notification-item empty-card" wx:else>
          <view class="notification-header">
            <view class="notification-info">
              <text class="notification-title">ğŸ“¬ æš‚æ— æœªè¯»é€šçŸ¥</text>
              <text class="notification-time">ç³»ç»Ÿæç¤º</text>
            </view>
          </view>

          <view class="notification-content">
            <text class="notification-text">æ‚¨çš„æœªè¯»é€šçŸ¥å°†æ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œè¯·ç¨åæŸ¥çœ‹</text>
          </view>

          <view class="notification-footer">
            <text class="notification-type">ç³»ç»Ÿæç¤º</text>
          </view>
        </view>
      </block>

      <!-- å·²è¯»é€šçŸ¥å†…å®¹ -->
      <block wx:elif="{{activeTab === 1}}">
        <view class="notification-list" wx:if="{{readNotifications.length > 0}}">
          <view 
            class="notification-item read"
            wx:for="{{readNotifications}}"
            wx:key="notification_id"
          >
            <view class="notification-header">
              <view class="notification-info">
                <text class="notification-title">{{item.title}}</text>
                <text class="notification-time">{{formatTime(item.create_time)}}</text>
              </view>
              <view class="right-info">
                <text class="notification-date">{{item.create_time}}</text>
              </view>
            </view>

            <view class="notification-content">
              <text class="notification-text">{{item.content}}</text>
            </view>

            <view class="notification-footer">
              <text class="notification-type">{{item.target_type === 0 ? 'ç³»ç»Ÿé€šçŸ¥' : 'ä¸ªäººé€šçŸ¥'}}</text>
              <text class="read-time" wx:if="{{item.read_time}}">å·²è¯»äº: {{item.read_time}}</text>


            </view>
          </view>
        </view>

        <!-- ç©ºçŠ¶æ€å¡ç‰‡ -->
        <view class="notification-item empty-card" wx:else>
          <view class="notification-header">
            <view class="notification-info">
              <text class="notification-title">ğŸ“­ æš‚æ— å·²è¯»é€šçŸ¥</text>
              <text class="notification-time">ç³»ç»Ÿæç¤º</text>
            </view>
          </view>

          <view class="notification-content">
            <text class="notification-text">æ‚¨çš„å·²è¯»é€šçŸ¥å°†æ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œå·²è¯»çš„é€šçŸ¥ä¼šä¿ç•™ä¸€æ®µæ—¶é—´</text>
          </view>

          <view class="notification-footer">
            <text class="notification-type">ç³»ç»Ÿæç¤º</text>
          </view>
        </view>
      </block>

      <!-- åŠ è½½æ›´å¤š -->
      <view class="load-more" wx:if="{{hasMore && !loading && ((activeTab === 0 && unreadNotifications.length > 0) || (activeTab === 1 && readNotifications.length > 0))}}">
        <text class="load-more-text">ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
      </view>

      <!-- æ²¡æœ‰æ›´å¤š -->
      <view class="no-more" wx:if="{{!hasMore && ((activeTab === 0 && unreadNotifications.length > 0) || (activeTab === 1 && readNotifications.length > 0))}}">
        <text class="no-more-text">æ²¡æœ‰æ›´å¤šäº†</text>
      </view>
    </view>
  </view>
</view> 