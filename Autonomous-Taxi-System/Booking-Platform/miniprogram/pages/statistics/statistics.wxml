<navigation-bar title="æ•°æ®ç»Ÿè®¡" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<view class="container">
  <!-- å†…å®¹åŒºåŸŸå®¹å™¨ -->
  <view class="content-area">
    <!-- å¯¼èˆªæ  -->
    <view class="tab-navigation">
      <view 
        class="tab-navigation-item tab-orders {{currentTab === 0 ? 'active' : ''}}"
        bindtap="switchTab"
        data-index="0"
      >
        è®¢å•åˆ†æ
      </view>
      <view 
        class="tab-navigation-item tab-spending {{currentTab === 1 ? 'active' : ''}}"
        bindtap="switchTab"
        data-index="1"
      >
        æ¶ˆè´¹åˆ†æ
      </view>
      <view 
        class="tab-navigation-item tab-habits {{currentTab === 2 ? 'active' : ''}}"
        bindtap="switchTab"
        data-index="2"
      >
        å‡ºè¡Œåˆ†æ
      </view>
    </view>

    <!-- ç»Ÿè®¡å†…å®¹ -->
    <view class="statistics-content">
      <!-- è®¢å•åˆ†æé¡µé¢ -->
      <view class="orders-content" wx:if="{{currentTab === 0}}">
        <!-- è®¢å•è¶‹åŠ¿ç»Ÿè®¡ -->
        <view class="stats-section">
          <view class="section-title">ğŸ“ˆ è®¢å•è¶‹åŠ¿ç»Ÿè®¡</view>
          <view class="stats-grid">
            <view class="stat-card-mini">
              <view class="stat-number">{{orderAnalysis.trendData.length || 0}}</view>
              <view class="stat-desc">ç»Ÿè®¡å¤©æ•°</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">{{orderAnalysis.totalOrders || 0}}</view>
              <view class="stat-desc">æ€»è®¢å•æ•°</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">{{orderAnalysis.avgDaily || '0.0'}}</view>
              <view class="stat-desc">æ—¥å‡è®¢å•</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">{{orderAnalysis.maxDaily || 0}}</view>
              <view class="stat-desc">å•æ—¥æœ€é«˜</view>
            </view>
          </view>
        </view>

        <!-- è®¢å•çŠ¶æ€åˆ†å¸ƒ -->
        <view class="stats-section">
          <view class="section-title">ğŸ“Š è®¢å•çŠ¶æ€åˆ†å¸ƒ</view>
          <view class="status-list">
            <view class="status-item" wx:for="{{orderAnalysis.statusStats}}" wx:key="status">
              <view class="status-info">
                <view class="status-name">{{item.status}}</view>
                <view class="status-count">{{item.count}}å•</view>
              </view>
              <view class="status-percent">{{item.percentage}}%</view>
            </view>
          </view>
        </view>
      </view>

      <!-- æ¶ˆè´¹åˆ†æé¡µé¢ -->
      <view class="spending-content" wx:if="{{currentTab === 1}}">
        <!-- æ¶ˆè´¹è¶‹åŠ¿ç»Ÿè®¡ -->
        <view class="stats-section">
          <view class="section-title">ğŸ’° æ¶ˆè´¹è¶‹åŠ¿ç»Ÿè®¡</view>
          <view class="stats-grid">
            <view class="stat-card-mini">
              <view class="stat-number">Â¥{{spendingAnalysis.totalAmount || '0.00'}}</view>
              <view class="stat-desc">æ€»æ¶ˆè´¹é‡‘é¢</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">Â¥{{spendingAnalysis.avgOrderAmount || '0.00'}}</view>
              <view class="stat-desc">å¹³å‡å•ä»·</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">Â¥{{spendingAnalysis.maxOrderAmount || '0.00'}}</view>
              <view class="stat-desc">æœ€é«˜å•ä»·</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">Â¥{{spendingAnalysis.minOrderAmount || '0.00'}}</view>
              <view class="stat-desc">æœ€ä½å•ä»·</view>
            </view>
          </view>
        </view>

        <!-- æ”¯ä»˜æ–¹å¼åˆ†å¸ƒ -->
        <view class="stats-section">
          <view class="section-title">ğŸ’³ æ”¯ä»˜æ–¹å¼åˆ†å¸ƒ</view>
          <view class="payment-list">
            <view class="payment-item" wx:for="{{spendingAnalysis.paymentMethods}}" wx:key="method">
              <view class="payment-info">
                <view class="payment-name">{{item.method}}</view>
                <view class="payment-count">{{item.count}}æ¬¡</view>
              </view>
              <view class="payment-percent">{{item.percentage}}%</view>
            </view>
          </view>
        </view>
      </view>

      <!-- å‡ºè¡Œä¹ æƒ¯é¡µé¢ -->
      <view class="habits-content" wx:if="{{currentTab === 2}}">
        <!-- å‡ºè¡Œæ—¶é—´ç»Ÿè®¡ -->
        <view class="stats-section">
          <view class="section-title">ğŸ• å‡ºè¡Œæ—¶é—´ç»Ÿè®¡</view>
          <view class="stats-grid">
            <view class="stat-card-mini">
              <view class="stat-number">{{travelHabits.peakHour || 'æš‚æ— '}}</view>
              <view class="stat-desc">é«˜å³°æ—¶æ®µ</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">{{travelHabits.totalTrips || 0}}</view>
              <view class="stat-desc">æ€»å‡ºè¡Œæ¬¡æ•°</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">{{travelHabits.avgDistance || '0.0'}}km</view>
              <view class="stat-desc">å¹³å‡è·ç¦»</view>
            </view>
            <view class="stat-card-mini">
              <view class="stat-number">{{travelHabits.favoriteCity || 'æš‚æ— '}}</view>
              <view class="stat-desc">å¸¸ç”¨åŸå¸‚</view>
            </view>
          </view>
        </view>

        <!-- åŸå¸‚åˆ†å¸ƒ -->
        <view class="stats-section">
          <view class="section-title">ğŸ™ï¸ åŸå¸‚åˆ†å¸ƒ</view>
          <view class="city-list">
            <view class="city-item" wx:for="{{travelHabits.cityDistribution}}" wx:key="city">
              <view class="city-info">
                <view class="city-name">{{item.city}}</view>
                <view class="city-count">{{item.count}}æ¬¡</view>
              </view>
              <view class="city-percent">{{item.percentage}}%</view>
            </view>
          </view>
        </view>

        <!-- æ—¶é—´åˆ†å¸ƒè¯¦æƒ… -->
        <view class="stats-section">
          <view class="section-title">â° æ—¶é—´åˆ†å¸ƒè¯¦æƒ…</view>
          <view class="time-grid">
            <view class="time-item" wx:for="{{travelHabits.timeDistribution}}" wx:key="hour" wx:if="{{item.count > 0}}">
              <view class="time-hour">{{item.hour}}:00</view>
              <view class="time-count">{{item.count}}æ¬¡</view>
            </view>
          </view>
        </view>
      </view>

      <!-- åŠ è½½çŠ¶æ€ -->
      <view class="loading-state" wx:if="{{loading}}">
        <view class="loading-text">åŠ è½½ä¸­...</view>
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{!loading && isEmpty}}">
        <view class="empty-icon">ğŸ“Š</view>
        <view class="empty-text">æš‚æ— ç»Ÿè®¡æ•°æ®</view>
        <view class="empty-desc">å®Œæˆæ›´å¤šè®¢å•åæŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡</view>
      </view>
    </view>
  </view>
</view> 