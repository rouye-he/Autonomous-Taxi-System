<navigation-bar title="æˆ‘çš„è®¢å•" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<view class="container">
  <view class="tab-header">
    <view class="tab {{currentTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-index="0">
      å…¨éƒ¨
      <text class="tab-count" wx:if="{{orderStats.all > 0}}">({{orderStats.all}})</text>
    </view>
    <view class="tab {{currentTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-index="1">
      å¾…åˆ†é…
      <text class="tab-count" wx:if="{{orderStats.pending > 0}}">({{orderStats.pending}})</text>
    </view>
    <view class="tab {{currentTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-index="2">
      è¿›è¡Œä¸­
      <text class="tab-count" wx:if="{{orderStats.ongoing > 0}}">({{orderStats.ongoing}})</text>
    </view>
    <view class="tab {{currentTab === 3 ? 'active' : ''}}" bindtap="switchTab" data-index="3">
      å·²ç»“æŸ
      <text class="tab-count" wx:if="{{orderStats.completed > 0}}">({{orderStats.completed}})</text>
    </view>
    <view class="tab {{currentTab === 4 ? 'active' : ''}}" bindtap="switchTab" data-index="4">
      å·²å–æ¶ˆ
      <text class="tab-count" wx:if="{{orderStats.cancelled > 0}}">({{orderStats.cancelled}})</text>
    </view>
  </view>
  
  <!-- å›ºå®šçš„å†…å®¹åŒºåŸŸ -->
  <view class="content-area">
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-container" wx:if="{{loading && orders.length === 0}}">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
    
    <!-- è®¢å•åˆ—è¡¨ -->
    <view class="order-list" wx:elif="{{orders.length > 0}}">
      <view class="order-item" wx:for="{{orders}}" wx:key="order_id">
        <view class="order-header">
          <text class="order-number">è®¢å•å·: {{item.order_number}}</text>
          <text class="order-status {{item.status === 'å·²ç»“æŸ' ? 'status-completed' : item.status === 'å·²å–æ¶ˆ' ? 'status-canceled' : 'status-ongoing'}}">{{item.status}}</text>
        </view>
        <view class="order-content">
          <view class="location-info">
            <view class="start-point">
              <view class="point-dot start-dot"></view>
              <view class="point-details">
                <text class="point-address">èµ·ç‚¹ä½ç½® <text class="point-coords" wx:if="{{item.pickup_location_x && item.pickup_location_y}}">({{item.pickup_location_x}}, {{item.pickup_location_y}})</text></text>
              </view>
            </view>
            <view class="end-point">
              <view class="point-dot end-dot"></view>
              <view class="point-details">
                <text class="point-address">ç»ˆç‚¹ä½ç½® <text class="point-coords" wx:if="{{item.dropoff_location_x && item.dropoff_location_y}}">({{item.dropoff_location_x}}, {{item.dropoff_location_y}})</text></text>
              </view>
            </view>
          </view>
          <view class="order-details">
            <view class="order-info">
              <text>æ—¶é—´: {{item.create_time}}</text>
              <text wx:if="{{item.distance > 0}}">è·ç¦»: {{item.distance}}å…¬é‡Œ</text>
              <text wx:if="{{item.city_code}}">åŸå¸‚: {{item.city_code}}</text>
            </view>
            <view class="price" wx:if="{{item.status === 'å·²ç»“æŸ' || item.amount > 0}}">Â¥{{item.amount || 0}}</view>
          </view>
        </view>
        <view class="order-footer" wx:if="{{item.status === 'å¾…åˆ†é…' || item.status === 'è¿›è¡Œä¸­' || item.status === 'å·²ç»“æŸ'}}">
          <button class="order-btn" wx:if="{{item.status === 'å¾…åˆ†é…'}}" bindtap="onOrderAction" data-action="cancel" data-order-number="{{item.order_number}}">å–æ¶ˆè®¢å•</button>
          <view class="ongoing-actions" wx:if="{{item.status === 'è¿›è¡Œä¸­'}}">
            <button class="order-btn report-btn" bindtap="onOrderAction" data-action="report" data-order-number="{{item.order_number}}">ä¸ŠæŠ¥å¼‚å¸¸</button>
          </view>
          <button class="order-btn" wx:if="{{item.status === 'å·²ç»“æŸ'}}" bindtap="onOrderAction" data-action="evaluate" data-order-number="{{item.order_number}}">è¯„ä»·</button>
        </view>
      </view>
      
      <!-- åŠ è½½æ›´å¤šæç¤º -->
      <view class="load-more" wx:if="{{hasMore}}">
        <text class="load-more-text" wx:if="{{loading}}">åŠ è½½ä¸­...</text>
        <text class="load-more-text" wx:else>ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
      </view>
      <view class="no-more" wx:else>
        <text class="no-more-text">æ²¡æœ‰æ›´å¤šè®¢å•äº†</text>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€å¡ç‰‡ -->
    <view class="order-item empty-card" wx:else>
      <view class="order-header">
        <text class="order-number">ğŸš— æš‚æ— {{getTabName(currentTab)}}è®¢å•</text>
        <text class="order-status status-empty">ç³»ç»Ÿæç¤º</text>
      </view>
      <view class="order-content">
        <view class="location-info">
          <view class="start-point">
            <view class="point-dot start-dot"></view>
            <text class="point-address">æ‚¨çš„{{getTabName(currentTab)}}è®¢å•å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</text>
          </view>
          <view class="end-point">
            <view class="point-dot end-dot"></view>
            <text class="point-address">å¿«å»ä½“éªŒæˆ‘ä»¬çš„æ— äººé©¾é©¶å‡ºç§Ÿè½¦æœåŠ¡å§</text>
          </view>
        </view>
        <view class="order-details">
          <view class="order-info">
            <text>æç¤º: æ‚¨å¯ä»¥åœ¨é¦–é¡µé¢„çº¦å‡ºè¡ŒæœåŠ¡</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</view> 